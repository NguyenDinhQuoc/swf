%!TEX root = ./nips_2018_sketchmcmc.tex

\subsection{Finite-time analysis for the infinite particle regime}



In this section we will analyze the behavior of the proposed algorithm in the asymptotic regime where the number of particles $N \rightarrow \infty$. Within this regime, we will assume that the original SDE \eqref{eqn:sde} can be directly simulated by using an approximate Euler-Maruyama scheme, defined as follows:
\begin{align}
\bar{X}_0 \simiid \mu_0, \quad \qquad \bar{X}_{k+1} = \bar{X}_k + h \hspace{0.5pt} \hat{v}(\bar{X}^i_k, \bar{\mu}_{kh} ) + \sqrt{2 \lambda h} Z_{k+1}, \qquad
\end{align}
where $\muh_{Kh}$ denotes the law of $\bar{X}_K$ with step size $h$ and $\{Z_k\}_{k}$ denotes a collection of standard Gaussian random variables. Apart from its theoretical significance, this scheme is also practically relevant, since one would expect that it would capture the behavior of the particle method \eqref{eqn:euler_particle} with large number of particles. 

We are interested in computing the distance $\| \muh_{Kh} - \nu_\lambda \|_{\TV}$, where , assuming , and $\|\mu-\nu\|_{\TV}$ denotes the total variation distance between two probability measures $\mu$ and $\nu$: $\|\mu-\nu\|_{\TV}\triangleq \sup_{A \in {\cal B}(\Omega)} |\mu(A) -\nu(A) |$. In order to upper-bound this distance, we follow the approach presented in \cite{dalalyan2017theoretical} and \cite{raginsky17a}, where we decompose the into two terms: $\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \| \muh_{Kh} - \mu_T \|_{\TV} + \| \mu_{T} - \nu_\lambda \|_{\TV}$, where $\mu_T$ denotes the law of $X_T$ such that $T=Kh$.

% By Theorem 5.6.1 of \cite{bonnotte2013unidimensional}, we know that $\Psi_t$ is Lipschitz continuous. 

% \Cref{asmp:sde_ergo,asmp:sde_expconv,asmp:lipschitz,asmp:stochgrad,asmp:dissip,asmp:init_fun}

\begin{thm}
\label{thm:euler}
Assume that the conditions given in the supplementary document hold. Then, the following bound holds:
\begin{align}
\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \sqrt{\delta_\lambda} \left \lbrace  \frac{L^2 K}{4\lambda} \Bigl( \frac{C_1 h^3}{3} + 3 \lambda d h^2 \Bigr) + \frac{C_2  \delta K h}{8\lambda} \right \rbrace^{1/2} +  C_3 \exp(-C_4 Kh \lambda),
\end{align}
for $C_1 \triangleq 12(L^2 C_0 + B^2)+1$, $C_2 \triangleq 2 (L^2 C_0 + B^2)$, $C_0 \triangleq C_e +2  (1 \vee \frac1{m})(b+2B^2 + d \lambda)$, $\delta_\lambda = (1 -{KL^2h}/{8\lambda})^{-1} $ and some $C_3,C_4 > 0$. Here, $C_e$ denotes the entropy of $\mu_0$.
\end{thm}

\begin{cor}
  \label{coro:precision}
  Assume that the conditions of Theorem~\ref{thm:euler} hold. Then for all $\varepsilon >0$, setting
  % \begin{align}
$T = Kh  = \ceil{\log(2C_3/\varepsilon)/(C_4\lambda)}$, % \, , \qquad 
$h = (3/C_1)\wedge\left(\frac{\varepsilon^2 \lambda}{L^2 T}(1+3\lambda d)^{-1}\right)^{1/2}$, % \,,
  % \end{align}
  we have
  % \begin{align}
    $\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \varepsilon + \left(\frac{C_2 \delta K h}{8\lambda}\right)^{1/2} $. 
  % \end{align}
\end{cor}

