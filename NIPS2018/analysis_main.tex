%!TEX root = ./nips_2018_sketchmcmc.tex

\subsection{Finite-time analysis for the infinite particle regime}

\newcommand{\minvsp}{-5}

In this section we will analyze the behavior of the proposed algorithm in the asymptotic regime where $N \rightarrow \infty$. We are interested in computing the distance $\| \muh_{Kh} - \nu_\lambda \|_{\TV}$, where $\muh_{Kh}$ denotes the law of $\bar{X}_K$ with step size $h$, assuming that the SDE \eqref{eqn:sde} can be directly simulated by using an Euler-Maruyama scheme, and $\|\mu-\nu\|_{\TV}$ denotes the total variation distance between two probability measures $\mu$ and $\nu$: $\|\mu-\nu\|_{\TV}\triangleq \sup_{A \in {\cal B}(\Omega)} |\mu(A) -\nu(A) |$. In order to upper-bound this distance, we follow the approach presented in \cite{dalalyan2017theoretical} and \cite{raginsky17a}, where we decompose the into two terms: $\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \| \muh_{Kh} - \mu_T \|_{\TV} + \| \mu_{T} - \nu_\lambda \|_{\TV}$, where $\mu_T$ denotes the law of $X_T$ such that $T=Kh$.

% By Theorem 5.6.1 of \cite{bonnotte2013unidimensional}, we know that $\Psi_t$ is Lipschitz continuous. 

We consider the following assumptions: \vspace{\minvsp pt}
\begin{assumption}
\label{asmp:sde_ergo}
For all $\lambda >0$, the SDE  \eqref{eqn:sde} has a unique strong solution denoted by $(X_t)_{t\geq 0}$ for any starting point $x \in \R^d$. It defines a non-homogenous Markov semi-group $(P_{s,t})_{t\geq s\geq 0}$ which admits a unique invariant measure denoted by $\nu_\lambda$. 
\vspace{\minvsp pt}
\end{assumption}
%
\begin{assumption}
\label{asmp:sde_expconv}
The probability measure of the diffusion $(\mu_t)_{t\geq 0}$ converges exponentially to its invariant measure $\nu_\lambda$, i.e.\ there exists $C_0, C_1 >0$, such that
% \begin{align}
$\|\mu_t - \nu_\lambda \|_{\TV} \leq C_0 \exp(-C_1 t \lambda)$.
% \end{align}
\vspace{\minvsp pt}
\end{assumption}
%
\begin{assumption}
\label{asmp:lipschitz}
% The drift is Lipschitz continuous, i.e.\ t
There exits $L < \infty$ such that
% \begin{align}
$\| v_t(x) - v_{t'}(x') \| \leq L ( \|x-x' \| + |t-t'|)$.
% \end{align}
\vspace{\minvsp pt}
\end{assumption}
%
\begin{assumption}
\label{asmp:dissip}
For all $t \geq 0$, $v_t$ is dissipative, i.e. for all $x \in \R^d$,
% \begin{align}
$\langle x, v_t(x) \rangle \geq m \|x\|^2 -b$,
% \end{align}
for some $m,b >0$.
\vspace{\minvsp pt}
\end{assumption}
%
\begin{assumption}
\label{asmp:stochgrad}
The estimator of the drift satisfies the following conditions: \ $\E[\hat{v}_t] = v_t$ for all $t \geq 0$, and for all $t\geq 0$, $x \in \R^d$,
% \begin{align}
$\E[ \|\hat{v}_t(x) - v_t(x) \|^2] \leq 2 \delta(L^2 \|x\|^2 + B^2)$,
% \end{align}
for some $\delta \in (0,1)$.
\vspace{\minvsp pt}
\end{assumption}
%
\begin{assumption}
\label{asmp:init_fun}
For all $t \geq 0$: $|\Psi_t(0)| \leq A$ and $\|v_t(0)\| \leq B$,
% \begin{align}
% |\Psi_t(0)| \leq A, \qquad \text{and} \qquad \|v_t(0)\| \leq B
% \end{align}
for $A,B \geq 0$.
% \vspace{\minvsp pt}
\end{assumption}


 %$(X_t)_t$ is the solution of the continuous-time SDE \eqref{eqn:sde} and 

We start by upper-bounding the first term. 
%
\begin{lemma}
\label{lem:euler}
Assume that the conditions \Cref{asmp:lipschitz,asmp:stochgrad,asmp:dissip,asmp:init_fun} hold. Then, the following bound holds:
\begin{align}
\| \muh_{Kh} - \mu_{T} \|_{\TV}^2 \leq \frac{L^2 K}{4\lambda} \Bigl( \frac{C_1 h^3}{3} + 3 \lambda d h^2 \Bigr) + \frac{C_2 \delta K h}{8\lambda},
\end{align}
where the constants $C_1$ and $C_2$ are explicitly defined in the proof. 
\end{lemma}


\begin{thm}
\label{thm:euler}
Assume that \Cref{asmp:sde_ergo,asmp:sde_expconv,asmp:lipschitz,asmp:stochgrad,asmp:dissip,asmp:init_fun} hold. Then, the following bound holds:
\begin{align}
\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \left \lbrace  \frac{L^2 K}{4\lambda} \Bigl( \frac{C_1 h^3}{3} + 3 \lambda d h^2 \Bigr) + \frac{C_2  \delta K h}{8\lambda} \right \rbrace^{1/2} +  C_3 \exp(-C_4 Kh \lambda),
\end{align}
for some $C_1,C_2,C_3,C_4 > 0$.
\end{thm}

\begin{cor}
  \label{coro:precision}
  Assume that \Cref{asmp:sde_ergo,asmp:sde_expconv,asmp:lipschitz,asmp:stochgrad,asmp:dissip,asmp:init_fun} hold. Then for all $\varepsilon >0$, setting
  % \begin{align}
$T = Kh  = \ceil{\log(2C_3/\varepsilon)/(C_4\lambda)}$, % \, , \qquad 
$h = (3/C_1)\wedge\left(\frac{\varepsilon^2 \lambda}{L^2 T}(1+3\lambda d)^{-1}\right)^{1/2}$, % \,,
  % \end{align}
  we have
  % \begin{align}
    $\| \muh_{Kh} - \nu_\lambda \|_{\TV} \leq \varepsilon + \left(\frac{C_2 \delta K h}{8\lambda}\right)^{1/2} $. 
  % \end{align}
\end{cor}

